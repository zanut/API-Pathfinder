<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Average Monthly Rainfalls</title>
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
<body>
  <div id="chart" style="width:100%;height:75vh;"></div>
  <select id="dataComboBox">
    <!-- Options will be populated dynamically -->
  </select>
  <button id="plotButton">Plot Graph</button>
  <div id="chartContainer"></div>
  <script>
    async function fetchDataAndPlot() {
    try {
      // Fetch data from your API endpoint
      const response = await fetch('http://localhost:3000/your-api-endpoint');
      const data = await response.json(); // Assuming your API returns JSON data

      // Get the combo box and button elements from the DOM
      const comboBox = document.getElementById('dataComboBox');
      const plotButton = document.getElementById('plotButton');

      // Clear existing options in the combo box
      comboBox.innerHTML = '';

      // Populate the combo box with fetched data
      data.forEach(item => {
        const option = document.createElement('option');
        option.value = item.id; // Set the value of the option (e.g., item ID)
        option.text = item.name; // Set the text displayed in the combo box (e.g., item name)
        comboBox.appendChild(option);
      });

    // Add click event listener to the plot button
        plotButton.addEventListener('click', () => {
          const selectedValue = comboBox.value; // Get the selected value from the combo box

          // Now you can use the selected value in your GraphQL query or other code for plotting the graph
          const query = `
            Your GraphQL query using the selectedValue
          `;

          // Placeholder function for plotting the graph (replace with your actual graph plotting logic)
          plotGraph(query);
        });
    } catch (error) {
      console.error('Error fetching data:', error);
      }
    }

// Placeholder function for plotting the graph (replace with your actual graph plotting logic)
  function plotGraph(query) {
    console.log('Plotting graph with query:', query);
    // Add your graph plotting code here
    var resp = await fetch('http://localhost:3000/graphql', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Accept': 'application/json',
        },
        body: JSON.stringify({
          query: query
  }

// Call fetchDataAndPlot when the page loads
  fetchDataAndPlot();
  </script>
</body>
</html>
